[English](./RELEASE.md) | 简体中文

# # Chatspeed v1.1.16 发布日志

- 删除了内置的供应商`Pollinations`，经过测试大多数时候无法使用
- 修复了初次安装语言设置有误导致指向简体中文的 bug，修复后将使用用户本机的语言，如果不支持会回退到英文
- 修复快捷键设置时，如果快捷键为空出错的提示
- 新增了主窗口居中快捷键
- 主窗口启动到左下角和右下角的快捷键直接变成全局快捷键
- 修复快捷键未设置导致绑定模块快捷键失败的 bug
- 修复了设置窗口打开后通过菜单切换其他设置窗口失效的 bug
- 统一了所有自定义事件为`cs://`开头

# Chatspeed v1.1.15 发布日志

v1.1.15 专注于提升工具调用的用户体验和系统稳定性，同时优化了 ccproxy 模块的协议转换能力。

### ✨ 功能增强
1. 优化了工具调用展示界面，同一轮会话中的多次工具调用现在会展示为单个会话
2. 优化了消息删除功能，删除消息时会一次性删除同一轮对话的所有工具调用信息
3. 优化了对话入口，现在所有对话错误都会通知给前端
4. 优化了错误信息，对于 HTTP 请求相关错误会返回状态码，便于前端根据情况进行适配
5. 优化了对话中的 Markdown 解析，采用流式解析机制，极大提高了解析效率和用户体验
6. 主窗口新增了 `ALT + ←/→` 快捷键，用于快速将窗口移动到左下角和右下角

### 🔧 技术优化
7. 优化了 ccproxy 模块的对话历史，在协议转换前预处理对话记录和工具调用记录，使其尽可能适合各种协议
8. 优化了 ccproxy 模块，现在可以通过定义注入模型条件，支持`*`和`?`通配符
9. 优化了数据库升级逻辑，利于后续版本更新管理

### 🐞 Bug 修复
10. 修复了一些模型（如 gtp-oss）在工具调用时因未按标准发送结束标志导致的工具调用中断问题，提高系统兼容性
11. 修复了 ccproxy 模块 gemini 协议转 claude 协议在复杂场景下工具结构不正确的问题

### 🕰 进行中
已经完成部分 ReAct 逻辑，接下来继续开发该工作流模块

# Chatspeed v1.1.14 发布日志

本次更新重点引入了**代理别名通配符支持**，极大地提升了模型配置的灵活性和便捷性。现在，您可以利用 `*` 和 `?` 等通配符来定义代理别名，无需频繁修改配置即可适应模型名称的变化。此外，我们还优化了搜索爬虫的过滤机制，修复了对话界面工具展开的 bug，并对模型配置流程进行了优化。

### ✨ 功能增强
- 优化了搜索爬虫，现在会自动过滤多媒体网站和多媒体文件，返回结果将按要求更精准。同时，`WebSearch` 工具的默认返回结果数量调整为 5 条，最大支持 30 条，以提供更灵活的搜索控制。
- 新增了代理别名通配符支持，现在支持通过`*`匹配多字符和`?`匹配单字符

### 🔧 技术优化
- 调整了 api 文档，以适配新的 MCP 代理
- 调整模型配置时，导入按钮从不可见变为禁用状态，以优化时间

### 🐞 Bug 修复
- 修复了对话界面有些工具无法展开的 bug

---

# Chatspeed v1.1.13 发布日志

本次更新专注于提升 MCP 代理的稳定性和功能扩展，同时优化了助手功能和内容提取能力。MCP 代理服务器方面，我们引入了 Streamable HTTP 协议解决了网络断连和电脑休眠导致的会话丢失问题。爬虫模块方面，我们修复了影响爬虫模块稳定性的关键问题，内容提取采用了 Readability 来提高内容区域识别准确性，减少垃圾信息带来的 token 不必要消耗。

### ✨ 功能增强

- **新增 openai 引用信息拓展字段**：为 OpenAI 兼容接口增加了引用信息的拓展字段，提供更丰富的引用数据。
- **优化助手快速发送信息功能**：优化了助手快速发送信息的体验（默认快捷键 `ALT+Z`），提升操作效率。
- **新增 Streamable HTTP 代理服务器协议**：新增 Streamable HTTP 代理服务器协议，入口端点为 `/mcp/http`，提供了更灵活的连接方式。
- **实现 Streamable HTTP 会话持久化与自动恢复**：通过引入先进的会话管理机制，实现了 Streamable HTTP 会话的磁盘持久化和自动恢复。这彻底解决了因网络断开、电脑休眠或代理服务器重启导致的 MCP 服务会话 ID 丢失（表现为 410 或 401 错误）问题，显著提升了连接的稳定性和用户体验。
- **优化爬虫模块内容提取**：优化了爬虫模块内容提取算法，当前版本在提取网页内容时可以精准识别内容区域，命中率提升至 90% ~ 95%。
- **重构 AI 对话机制**：重构了 AI 对话机制，现在的界面可以更好地展示工具调用过程；优化了系统提示词，使得 AI 可以更好地利用工具完成日常对话任务。
- **更新文档链接**：更新了 README 中的博客链接和英文文档链接，确保用户可以访问最新的文档资源。

### 🔧 技术优化

- **清理无效的 i18n**：清理了大量无效的国际化资源，减少应用体积并提升性能。
- **助手窗口大小调整**：调整了助手窗口大小，并实现自动根据用户调整大小进行还原，提升用户体验。
- **归档 Rust 实现的 ReAct 模块**：基于工作流模块调整，归档了原先 Rust 实现的 ReAct 模块，为新的工作流架构做准备。
- **采用 Readability 提高内容识别准确性**：爬虫模块我们采用了 Readability 算法来提高内容区域识别准确性，减少垃圾信息带来的 token 不必要消耗。

### 🐞 Bug 修复

- **修复 scraper 模块事件监听崩溃问题**：修复了 scraper 模块事件监听可能导致爬虫模块崩溃的问题，显著提升了爬虫功能的稳定性。
- **移除未使用的导入和依赖**：清理了项目中未使用的导入和依赖，优化了项目结构和构建效率。

---

# Chatspeed v1.1.12 发布日志

v1.1.12 版本专注于提升核心稳定性和优化关键用户体验。我们修复了可能导致程序崩溃的底层问题，并改进了助手和应用启动的工作流程，使其更加流畅和直观。

### ✨ 功能增强

- **优化助手快捷键工作流**: 现在，使用助手快捷键（默认为 `Alt+Z`）会直接发送粘贴板中的文本进行处理，无需再次按回车键确认，显著提升了操作效率。
- **改善应用首次启动体验**: 为了提供更友好的初始界面，应用在首次启动时会自动加载默认会话，而不是显示空白页。

### 🐞 Bug 修复

- **修复助手快捷键重复触发问题**: 解决了在某些情况下，助手快捷键会连续触发两次，导致同一条消息被重复发送给 AI 的问题。
- **修复采集器（Scraper）模块崩溃问题**: 修复了因 `scraper` 模块中的事件监听器处理不当而可能引发程序崩溃（panic）的严重问题，提升了网页内容抓取功能的稳定性。

### 🔧 技术优化

- **优化数据库初始化逻辑**: 移除了为初始会话硬编码的创建时间，改为在数据库首次创建时动态生成，使逻辑更加严谨。

---

# Chatspeed v1.1.11 发布日志

本次更新，我们专注于优化 AI 工具调用的稳定性和准确性，通过改进系统提示词和解析逻辑，让 AI 能够更可靠地使用工具来解答用户的问题。

### ✨ 功能增强

- 优化了聊天系统提示词，让 AI 可以更好地使用工具来解答用户的问题
- 优化了工具兼容模式的使用规范，提供更明确的使用示例让 AI 可以更好地理解并遵循工具 XML 使用规范
- 增强了 `WebFetch` 工具的稳定性，通过避免下载无法解析的文件（如 PDF, ZIP），提高了网页抓取功能的可靠性

### 🐞 Bug 修复

- 修复了工具兼容模式下工具调用解析会错误的将类似`Result<String, String>`代码解析为 HTML，导致工具调用失败的问题

---

# Chatspeed v1.1.10 发布日志

本次更新，我们致力于提升视觉体验与 AI 交互效率。通过新增 SVG 图表全屏显示功能，优化了视觉呈现；同时，我们精简了工具兼容模式的提示词，显著降低了 token 消耗，并引入了智能 token 估算，为您带来更流畅、更经济、更透明的 AI 使用体验。

### ✨ 效率与体验提升

1. 为 SVG 图表新增全屏显示支持，优化视觉体验
2. 优化工具兼容模式的提示词，删除与工具使用说明无关的信息，大大减小 token 消耗
3. 如果某些 AI 服务器返回的数据不包含输入输出 token，我们添加了估算值，主要用于提高用户感知

---

# Chatspeed v1.1.9 发布日志

v1.1.9 版本专注于修复关键 Bug、提升核心稳定性与统一跨平台体验。我们解决了在工具调用、MCP 代理、Windows 构建及 UI 兼容性方面的一系列问题，让您的 AI
交互体验更加流畅、可靠和美观。

🐞 Bug 修复

- 修复 MCP 代理重启后工具不可用的问题：解决了因 MCP 服务器重启导致客户端工具映射丢失的严重 Bug，确保了在重连后工具的可用性和会话的连续性。
- 修复多轮工具调用失败的问题：修复了在连续的多轮对话中，工具列表未能正确传递导致的工具调用失败问题。
- 修复采集器（Scraper）卡死问题：解决了内置网页采集器在使用一段时间后可能无法继续执行任务的问题，提升了长时间使用的稳定性。
- 修复工具调用UI点击事件Bug：修复了在聊天界面中，工具调用展示组件的点击事件失效问题。
- 修复 macOS 窗口边框问题：解决了在 macOS 平台上，应用窗口在某些情况下出现意外边框影响美观的问题。
- 修复工具调用参数问题：修复了代理模块工具兼容模式下整数类型解析存储后输出时可能被错误转为 number浮点型。
- **修复 Windows 初始化弹窗问题**：修复了在 Windows 平台上，MCP 模块在初始化过程中因执行外部命令而意外弹出命令行窗口的问题，优化了应用的静默启动体验。
- **解决了 Windows 本地开发环境的编译问题**：修复了在 Windows（特别是 ARM64）本地开发环境中，因 `vcpkg` 依赖链接问题导致的编译失败。此项修复统一了各平台的构建方式，并为后续 CI/CD 流程的适配和优化奠定了基础。

✨ 功能增强

- 统一跨平台视觉体验：重构了窗口的圆角和阴影效果，确保应用在 Windows, macOS 和 Linux 上拥有一致、美观的视觉表现。
- 优化 `ccproxy` 模块：进一步优化了 ccproxy 的工具兼容模式和调用说明，在保证可用性的前提下，显著减少了 Token 消耗，使工作流更顺畅、更经济。
- 依赖更新：升级了项目依赖，其中核心的 rmcp 库从 v0.5 升级到 v0.6，带来了更好的性能和稳定性。

---

# Chatspeed v1.1.8 发布日志

本次更新我们专注于**用户体验的全面优化**和**核心功能的增强**，为你带来更流畅、更智能、更个性化的使用感受。

### ✨ 界面与交互优化

- **布局统一**: 重新设计了主界面顶部及输入框下方的工具栏布局，使整体交互更加统一和便捷。
- **MCP 开关**: 在主界面新增了 MCP（模型上下文协议）功能的全局控制开关，方便快速启用或禁用。
- **发送键自定义**: 在设置中增加了发送消息快捷键的切换功能，你现在可以根据习惯选择使用 `Enter` 或 `Shift+Enter` 来发送消息。

### 🚀 效率提升

- **新建会话快捷键**: 新增了全局快捷键 `Cmd/Ctrl + N`，让你随时随地都能快速开启一段新对话。
- **切换侧边栏**: 新增 `Cmd/Ctrl + B` 快捷键，用于快速展开或折叠会话列表侧边栏。

### 🧠 AI 核心增强

- **全局系统提示词**: 引入了全新的系统提示词（System Prompt），让 AI 能更好地理解你的环境和意图，从而提供更精准、更智能的回复。
- **API 兼容性修复**: 解决了历史消息中工具调用（Tool Call）的格式兼容性问题，避免了因此导致的 API 请求失败。
- **Markdown 解析修复**: 修复了文本中引用格式与标准 Markdown 语法可能产生的冲突，确保了引用链接的正确渲染。

---

# Chatspeed v1.1.7 发布日志

v1.1.7 是一个紧急修复版本，解决了因简化模型配置导致无法添加模型的问题。

## 🔧 紧急修复

- **修复模型添加问题**：修复了因模型配置结构更改导致无法添加新模型的紧急问题。

---

# Chatspeed v1.1.6 发布日志

v1.1.6 是一个热修复版本，修复了前端显示问题并更新了依赖。

## 🔧 Bug 修复与优化

- **修复前端显示问题**：修复了 助手界面 中解析服务器端返回的 AI 数据时的工具标志 bug，该问题导致任意文本都会增加工具标志，造成前端显示意外换行
- **依赖更新**：更新 element-plus 依赖版本从 v2.8.5 到 v2.11.0

---

# Chatspeed v1.1.5 发布日志

v1.1.5 版本合并了之前所有的功能更新，并修复了导致此前版本编译失败的生命周期问题。

## ✨ 新功能与增强

- **单实例锁**：实现了单实例锁，防止应用同时运行多个实例。此项修复解决了在 macOS 上设置开机自启动后，重启系统时会启动两个应用的问题。
- **Windows 采集器代理**：Windows 平台的网页采集器现在会使用应用内为非认证 HTTP 代理设置的代理，提升了网络配置的一致性。

## 🔧 Bug 修复与优化

- **修复编译错误**：解决了在创建采集器窗口时因状态锁生命周期不明确导致的编译失败问题 (E0597)。
- **补全语言选项**：补充了翻译技能中缺失的语言选项。
- **采集器可靠性提升**：通过为动态加载内容的页面实现指数退避重试机制，提升了通用网页采集器的可靠性。

---

# Chatspeed v1.1.2 发布日志

v1.1.2 版本重点优化了工具调用功能和用户体验，通过重构核心模块提升了稳定性和兼容性。

## ✨ 新功能与重大改进

1.  **全新工具调用架构**
    - 重构了聊天模块，通过 ccproxy 统一对接所有模型，使所有模型都具备工具调用能力
    - 简化了模型设置，移除了原有的"工具调用能力"开关，现在所有支持的模型都默认具备工具调用功能
    - 优化了工具调用的解析和展示，实时显示 AI 聊天过程中工具调用及其结果
    - 支持在历史聊天记录中完整展示工具调用记录

2.  **改进的用户界面 **
    - 新增联网控制开关，用户可以方便地控制是否启用网络搜索功能
    - 优化了聊天界面交互，工具调用部分现在以独立组件形式展示，支持展开/折叠查看参数和结果
    - 优化了模型添加流程，修复了可能无法显示"导入模型"按钮的问题

## 🔧 技术优化

- 重构了工具调用相关组件，提高了代码可维护性
- 优化了 ccproxy 认证机制，支持内部请求验证
- 改进了工具调用的解析逻辑，增强了对复杂参数的支持
- 更新了工具调用的展示样式，提供更好的视觉效果
- 优化了 ccproxy 模块的工具兼容模式，提升了对不同模型的适配性
- **优化了密钥轮换机制**: 重构了代理的密钥管理，采用原子化更新确保多密钥轮换的稳定性和可靠性，修复了潜在的竞态条件问题。

## 🐞 Bug 修复

- 修复了添加模型时可能无法显示"导入模型"按钮的问题
- 修复了工具调用结果显示不完整的问题
- 优化了网络请求处理，提升了稳定性
- 修复了部分界面显示问题，提升了用户体验

# Chatspeed v1.1.1 发布日志

v1.1.1 是一个以提升稳定性和修复问题为核心的维护版本。我们深入优化了 `ccproxy` 代理模块的内部逻辑，特别是在协议兼容性和工具处理方面，以确保更可靠、更精确的 AI 交互。

## ✨ 功能增强

1.  **重构了工具调用的核心解析引擎**
    我们调整并引入了全新的工具调用解析机制。新引擎具有更强的兼容性和鲁棒性，能够更好地理解并处理来自 AI 的多样化输出，这不仅提升了解析成功率，也降低了 AI 使用工具的难度。

2.  **统一并增强了全协议的工具兼容模式**
    工具兼容模式现已覆盖包括 Gemini 和 Claude 在内的所有协议。无论你使用何种后端模型，都能享受到通过增强引导带来的更流畅工作流和更高的目标完成率。

## 🐞 Bug 修复

- **修复了代理配置中“幽灵模型”的问题:** 解决了在编辑代理配置时，已删除的后端模型会残留在配置中且无法移除的问题。
- **修复了工具兼容模式下工具列表丢失的问题:** 解决了在特定场景下，启用工具兼容模式后，工具列表未能正确加载到提示词中的问题，确保了 AI 能够看到并使用所有可用工具。
- **修复了全局密钥轮换不均衡的问题:** 解决了因密钥轮换算法缺陷，导致部分密钥使用频率过高而超出速率限制（Rate Limit）的问题，确保了密钥使用的均衡性和服务的稳定性。

---

# Chatspeed v1.1.0 发布日志

大家好！我们非常激动地发布 Chatspeed v1.1.0 版本。本次我们从 v1.0.4 直接跳跃到 v1.1.0，因为它包含了一系列里程碑式的更新，特别是在**代理模块的工具兼容模式**和**搜索引擎支持**方面，这将极大地增强 AI 的能力和稳定性。

## 🚀 新增功能

1.  **强大的搜索引擎集成**
    - 现在支持通过 API 密钥接入主流搜索引擎，包括 **Google Search API**, **Tavily API**, 和 **Serper API**。
    - 同时，我们内置了对 **Bing, DuckDuckGo, So.com, Sougou** 等搜索引擎的直接支持，为您提供多样化的信息源。

2.  **网页内容抓取与分析**
    - 新增了内置的网页抓取器（Scraper），可以从指定 URL 中提取文本或 Markdown 内容，让 AI 能够获取和分析实时网页信息。

3.  **灵活的提示词注入位置**
    - 为了适配不同模型（特别是对 `system` 角色支持较弱的模型），现在您可以选择将增强提示词注入到 `system` 角色或最后一条 `user` 消息中，极大地提升了兼容性。

## ✨ 功能增强

本次更新的核心，是围绕代理模块的“工具兼容模式”进行的一系列深度优化，旨在提供更稳定、更兼容、更流畅的智能体验。

### 1. 更稳定的工具调用

通过对工具兼容模式的底层进行重构，我们极大地提升了 AI 执行工具的稳定性和准确性。优化的工具定义（必填项前置、`(required)`/`(optional)` 标注）和更严谨的格式规则，为 AI 提供了一套清晰的“护栏”，能更好地驱动不同模型（即使是能力稍弱的模型）稳定、准确地执行任务。

### 2. 可定制的跨模型兼容性

我们引入了灵活的提示词注入机制。现在，您可以选择将增强提示词注入到 `system` 或 `user` 消息中。这一功能使得我们可以针对不同模型的特性进行优化，解决了部分模型对 `system` 角色响应不佳的问题，显著改善了各类模型在 `claude code` 等客户端中的表现。

### 3. 通过提示词引导优化工作流

我们通过大幅优化提示词，来辅助 AI 形成更健壮、更不容易中断的工作流。这包括：通过引导 AI 进行任务规划（优先使用 `TodoWrite` 等工具），以及实现智能容错（在工具调用解析失败时提供详细的“纠错指南”），从而显著提升复杂任务的执行成功率。

## 🐞 Bug 修复

- 修复了在处理流式响应时，因状态管理被意外破坏而导致的工具调用解析失败问题。
- 修复了当 XML 参数值无法被解析为指定类型（如 number）时，会错误地变成 `0` 或 `false` 的问题，现在会安全地回退到保留原始字符串，避免了数据篡改。
